<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>skan.vendored.thresholding: Thresholding algorithms &mdash; Skan 0.9 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="skan.pre: Image preprocessing" href="skan.pre.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Skan
          </a>
              <div class="version">
                0.9
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installing Skan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started: Skeleton analysis with Skan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gui.html">Using Skan’s GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../complete_analysis.html">Complete analysis with Skan</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">Skan API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="skan.csr.html">skan.csr: CSR Graph representation of skeletons</a></li>
<li class="toctree-l2"><a class="reference internal" href="skan.draw.html">skan.draw: Skeleton visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="skan.pipe.html">skan.pipe:: Pipeline functions for skeleton analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="skan.pre.html">skan.pre: Image preprocessing</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">skan.vendored.thresholding: Thresholding algorithms</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Skan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="api.html">Skan API Reference</a> &raquo;</li>
      <li>skan.vendored.thresholding: Thresholding algorithms</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/skan.vendored.thresholding.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="skan-vendored-thresholding-thresholding-algorithms">
<h1>skan.vendored.thresholding: Thresholding algorithms<a class="headerlink" href="#skan-vendored-thresholding-thresholding-algorithms" title="Permalink to this headline">¶</a></h1>
<p>This version of Sauvola thresholding is extremely fast even for large window
sizes.</p>
<span class="target" id="module-skan.vendored.thresholding"></span><dl class="py function">
<dt id="skan.vendored.thresholding.correlate_sparse">
<code class="sig-prename descclassname"><span class="pre">skan.vendored.thresholding.</span></code><code class="sig-name descname"><span class="pre">correlate_sparse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'reflect'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/vendored/thresholding.html#correlate_sparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.vendored.thresholding.correlate_sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute valid cross-correlation of <cite>padded_array</cite> and <cite>kernel</cite>.</p>
<p>This function is <em>fast</em> when <cite>kernel</cite> is large with many zeros.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">scipy.ndimage.correlate</span></code> for a description of cross-correlation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>array of float</em><em>, </em><em>shape</em><em> (</em><em>M</em><em>, </em><em>N</em><em>,</em><em>[ </em><em>..</em><em>,</em><em>] </em><em>P</em><em>)</em>) – The input array. It should be already padded, as a margin of the
same shape as kernel (-1) will be stripped off.</p></li>
<li><p><strong>kernel</strong> (<em>array of float</em><em>, </em><em>shape</em><em> (</em><em>Q</em><em>, </em><em>R</em><em>,</em><em>[ </em><em>..</em><em>,</em><em>] </em><em>S</em><em>)</em>) – The kernel to be correlated. Must have the same number of
dimensions as <cite>padded_array</cite>. For high performance, it should
be sparse (few nonzero entries).</p></li>
<li><p><strong>mode</strong> (<em>string</em><em>, </em><em>optional</em>) – See <cite>np.pad</cite> for valid modes. Additionally, mode ‘valid’ is
accepted, in which case no padding is applied and the result is
the result for the smaller image for which the kernel is entirely
inside the original data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The result of cross-correlating <cite>image</cite> with <cite>kernel</cite>. If mode
‘valid’ is used, the resulting shape is (M-Q+1, N-R+1,[ …,] P-S+1).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of float, shape (M, N,[ ..,] P)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="skan.vendored.thresholding.threshold_niblack">
<code class="sig-prename descclassname"><span class="pre">skan.vendored.thresholding.</span></code><code class="sig-name descname"><span class="pre">threshold_niblack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/vendored/thresholding.html#threshold_niblack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.vendored.thresholding.threshold_niblack" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Niblack local threshold to an array. <a class="footnote-reference brackets" href="#id2" id="id1">1</a></p>
<p>A threshold T is calculated for every pixel in the image using the
following formula:</p>
<p>T = m(x,y) - k * s(x,y)</p>
<p>where m(x,y) and s(x,y) are the mean and standard deviation of
pixel (x,y) neighborhood defined by a rectangular window with size w
times w centered around the pixel. k is a configurable parameter
that weights the effect of standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>(</em><em>N</em><em>, </em><em>M</em><em>) </em><em>ndarray</em>) – Grayscale input image.</p></li>
<li><p><strong>window_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Odd size of pixel neighborhood window (e.g. 3, 5, 7…).</p></li>
<li><p><strong>k</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of parameter k in threshold formula.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>threshold</strong> – Threshold mask. All pixels with an intensity higher than
this value are assumed to be foreground.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N, M) ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This algorithm is originally designed for text recognition.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Niblack, W (1986), An introduction to Digital Image
Processing, Prentice-Hall.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_image</span> <span class="o">=</span> <span class="n">threshold_niblack</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="skan.vendored.thresholding.threshold_sauvola">
<code class="sig-prename descclassname"><span class="pre">skan.vendored.thresholding.</span></code><code class="sig-name descname"><span class="pre">threshold_sauvola</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/skan/vendored/thresholding.html#threshold_sauvola"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#skan.vendored.thresholding.threshold_sauvola" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply Sauvola local threshold to an array. <a class="footnote-reference brackets" href="#id4" id="id3">2</a></p>
<p>In the original method a threshold T is calculated for every pixel
in the image using the following formula:</p>
<p>T = m(x,y) * (1 + k * ((s(x,y) / R) - 1))</p>
<p>where m(x,y) and s(x,y) are the mean and standard deviation of
pixel (x,y) neighborhood defined by a rectangular window with size w
times w centered around the pixel. k is a configurable parameter
that weights the effect of standard deviation.
R is the maximum standard deviation of a greyscale image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>(</em><em>N</em><em>, </em><em>M</em><em>) </em><em>ndarray</em>) – Grayscale input image.</p></li>
<li><p><strong>window_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Odd size of pixel neighborhood window (e.g. 3, 5, 7…).</p></li>
<li><p><strong>k</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of the positive parameter k.</p></li>
<li><p><strong>r</strong> (<em>float</em><em>, </em><em>optional</em>) – Value of R, the dynamic range of standard deviation.
If None, set to the half of the image dtype range.</p></li>
<li><p><strong>offset</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant subtracted from obtained local thresholds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>threshold</strong> – Threshold mask. All pixels with an intensity higher than
this value are assumed to be foreground.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N, M) ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This algorithm is originally designed for text recognition.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>J. Sauvola and M. Pietikainen, “Adaptive document image
binarization,” Pattern Recognition 33(2),
pp. 225-236, 2000.
DOI:10.1016/S0031-3203(99)00055-2</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">page</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binary_sauvola</span> <span class="o">=</span> <span class="n">threshold_sauvola</span><span class="p">(</span><span class="n">image</span><span class="p">,</span>
<span class="gp">... </span>                                   <span class="n">window_size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="skan.pre.html" class="btn btn-neutral float-left" title="skan.pre: Image preprocessing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Juan Nunez-Iglesias.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>